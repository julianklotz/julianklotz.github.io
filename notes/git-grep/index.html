<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="stylesheet" href="/_astro/common-Z2h4J9B.css" type="text/css"><title>Finding code in git history</title><meta name="title" content="Finding code in git history"><meta name="description" content="Using git to search its history for a fragment of code"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""><link href="https://fonts.googleapis.com/css2?family=PT+Serif:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css2?family=Spartan:wght@600;700&amp;display=swap" rel="stylesheet"></head><body><header class="layout-page-header"><div class="layout-page-header__inner grid"><div class="layout-page-header__menu"><a href="/">Julian’s Blog</a></div></div></header><article class="layout-content"><div><header class="PostHeader"><div class="grid"><div class="col-2-5"><h1 class="PostHeader__title">Finding code in git history</h1><p class="PostHeader__publish-date">2022-02-02</p></div></div></header><main class=""><div class="grid grid--content"><p>Sometimes I wonder how I solved a certain problem years ago, and all I know is a piece of code I wrote (but deleted at some point).
To search the git history for this specific chunk of code, you can use:</p><pre><code>git grep "permissions = (" $(git rev-list --all)
</code></pre><p>This will search all revisions that have a line of code containing <code>permissions = (</code></p><p>Let’s take a closer look:
The manual says <code>git rev-list</code> “lists commit objects in reverse chronological order”. The <code>--all</code> switch makes sure we get commits from <em>all</em> branches: “Pretend as if all the refs in refs/, along with HEAD, are listed on the command line as <commit>.”</commit></p><p><code>git grep</code> lists lines that match a certain pattern, in our case <code>permissions = (</code>.
The <code>$(…)</code> interpolation passes the list of commits to search for grep.</p><h2 id="cant-i-just-use-git-grep-without-rev-list">Can’t I just use <code>git grep</code>, without <code>rev-list</code>?</h2><p>Sure you can, but when using <code>git grep</code> without arguments, it will only search the current working tree. If the piece of code you are looking for is no longer present, you won’t find anything.</p><p>Further reading:</p><ul><li>git rev-list manual: <a href="https://git-scm.com/docs/git-rev-list">https://git-scm.com/docs/git-rev-list</a></li><li>git grep manual: <a href="https://git-scm.com/docs/git-grep">https://git-scm.com/docs/git-grep</a></li></ul></div></main></div></article></body></html>